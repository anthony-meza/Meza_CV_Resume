%-------------------------------------
% Resum in LaTeX (XeLaTeX)
% Author:  HF Yuan
% Project: https://github.com/xyz-yuanhf/yuan-resume
% Base on: https://github.com/mattyHerzig/mattys_resume
%          http://www.jianxu.net/en/
% License: MIT
%------------------------------------

\NeedsTeXFormat{LaTeX2e}

% Page size
\usepackage[top=1.2cm, bottom=2.6cm, left=1.8cm, right=2.3cm, marginparwidth=1.75cm]{geometry}

% Packages
\usepackage{xcolor}
\usepackage{setspace}
\usepackage{titlesec}
\usepackage{enumitem}
\usepackage{tabularx}
\usepackage{ragged2e}
\usepackage{paracol}
\usepackage{needspace}

% Font style
\usepackage{fontspec}
\setmainfont{SabonLTStd}[
    Path=./Fonts/Sabon/,
    Extension = .ttf,
    UprightFont=*-Regular,
    BoldFont=*-Bold,
    ItalicFont=*-Italic,
    BoldItalicFont=*-BoldItalic
    ]
\newfontfamily\Calluna{Calluna}[
    Path=./Fonts/Calluna/,
    Extension = .otf,
    UprightFont=*-Regular
    ]
\newfontfamily\Courier{CourierNew}[
    Path=./Fonts/Courier/,
    Extension = .ttf,
    UprightFont=*-Regular
    ]
\newfontfamily\CronosLt{CronosProLT}[
    Path=./Fonts/Cronos/,
    Extension = .ttf,
    UprightFont=*-Regular
    ]

% Emph style
\renewcommand{\emph}[1]{\textbf{\fontsize{11pt}{11pt}\selectfont #1}}

% Section block using paracol for page breaks
\setlength{\columnsep}{0.45cm}
\setlength{\columnseprule}{0pt}
\newcommand{\sectionBlock}[2]{%
    \needspace{5\baselineskip}%
    \vspace{10pt}%
    \setcolumnwidth{2.7cm}
    \begin{paracol}{2}
    \raggedright
    \vspace{3pt}%
    #1%
    \switchcolumn
    \raggedright
    \vspace{5pt}%
    #2%
    \end{paracol}
    \vspace{10pt}%
}

% Section title
\titleformat{\section}{
  \setstretch{1.0}
  \CronosLt\scshape\raggedright
  \fontsize{14.5pt}{14.5pt}\selectfont
}{}{0em}{}
\titlespacing*{\section}{0pt}{0pt}{0pt}

% Header commands
\newcommand{\headerName}[1]{%
  {\Calluna \fontsize{30pt}{30pt}\selectfont \textsc{#1}}
}

\newcommand{\headerTitle}[1]{%
  {\Calluna \fontsize{14.5pt}{14.5pt}\selectfont \textsc{#1}}
}

\newcommand{\headerContact}[3]{%
  \begin{flushright}
  \setstretch{0.6}
  \vspace{1\baselineskip}
  \item {\Calluna #1}  % Phone number
  \item {\Calluna #2}  % E-mail address
  \item {\Calluna #3}  % Home page
  \end{flushright}\vspace{-55pt}
}

% Section content

% Publication list
\newcommand{\pubListStart}{\begin{itemize}[left=0pt, itemsep=0pt, parsep=0pt, topsep=0pt, partopsep=0pt]}
\newcommand{\pubListEnd}{\end{itemize}}

% Award list
\newcommand{\awardListStart}{\begin{itemize}[left=0pt, itemsep=0pt]}
\newcommand{\awardListEnd}{\end{itemize}\vspace{-11pt}}

% General entry (name/role, location/organization, date)
\newcommand{\entryItem}[3]{%
  \item \emph{#1} \hfill \textit{#3} \\#2
}

% Skill list
\newcommand{\skillListStart}{\begin{itemize}[leftmargin=0pt, label={}, itemsep=0pt, parsep=0pt, topsep=0pt, partopsep=0pt]}
\newcommand{\skillListEnd}{\end{itemize}\vspace{-11pt}}

% Item list
\newcommand{\itemListStart}{\begin{itemize}[itemsep=0pt]}
\newcommand{\itemListEnd}{\end{itemize}}
\newcommand{\myItem}[1]{
  \item{
    {#1 \vspace{-2pt}}
  }
}

% Item with alignment (for multi-line items that need alignment)
\newcommand{\myItemAlign}[1]{
  \item{
    \begin{tabular}[t]{@{}l@{ }l@{}}
      #1
    \end{tabular}
    \vspace{-2pt}
  }
}

% Education information
\newcommand{\eduHeading}[4]{
  \renewcommand{\arraystretch}{1.2}
    \begin{tabular}[t]{p{13.74cm}}
      \parbox[t]{\linewidth}{{\bfseries\fontsize{11pt}{11pt}\selectfont #1} \hfill #2} \\
      \textit{#3} \hfill #4 \\
    \end{tabular}\vspace{-7pt}
}

% Internship information
\newcommand{\internHeading}[4][]{
  \renewcommand{\arraystretch}{1.2}
    \begin{tabular}[t]{p{13.74cm}}
      \emph{#2} \hfill #4 \\
      \ifx&#1&\multicolumn{1}{r}{#3}\\\else\textit{#1} \hfill #3\\\fi
    \end{tabular}\vspace{-7pt}
}

% Project information
\newcommand{\projHeading}[3]{
  \renewcommand{\arraystretch}{1.2}
    \begin{tabular}[t]{p{13.74cm}}
      \textbf{#1} \hfill \\
      \textit{#2} \hfill #3 \\
    \end{tabular}\vspace{2pt}
}